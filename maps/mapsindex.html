<!DOCTYPE html>
<html>

<head>

    <title>Geolocation</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <!-- include the core styles -->
    <link rel="stylesheet" href="style.css" />

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>


    <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map.(53.106733, 8.84503) */
        
        .swal-overlay {
            background-color: rgba(43, 165, 137, 0.45);
        }
        
        #map {
            height: 100%;
        }
        /* Optional: Makes the sample page fill the window. */
        
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>

    <div id="map"></div>
    <script>
        var overlay;
        var gooMarker = [];
        var counter = 0;
        var universumMarker;
        const imageURL = "universum.jpg";
        const imageURLMaritim = "reef.jpg";
        const imageURLHaus = "haus.jpg";

        var partnerMarkers = [{
                lat: 53.106572,
                lng: 8.841387,
                name: "UniversumTest",
                content: "Our home town and international hub."
            },
            {
                lat: 54,
                lng: 8,
                name: "Middle East",
                content: "Dubai desc"
            }
        ]


        var chicago = {
            lat: 41.85,
            lng: -87.65
        };

        var universum = {
            lat: 53.106733,
            lng: 8.84503
        };


        var maritim = {
            lat: 53.108020,
            lng: 8.845980
        };

        var haus = {
            //  lat: 53.106572,
            // lng: 
        };

        function CenterControl(controlDiv, map) {

            // Set CSS for the control border.
            var controlUI = document.createElement('div');
            controlUI.style.backgroundColor = '#fff';
            controlUI.style.border = '2px solid #fff';
            controlUI.style.borderRadius = '3px';
            controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
            controlUI.style.cursor = 'pointer';
            controlUI.style.marginBottom = '22px';
            controlUI.style.textAlign = 'center';
            controlUI.title = 'Click to recenter the map';
            controlDiv.appendChild(controlUI);

            // Set CSS for the control interior.
            var controlText = document.createElement('div');
            controlText.style.color = 'rgb(25,25,25)';
            controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
            controlText.style.fontSize = '16px';
            controlText.style.lineHeight = '38px';
            controlText.style.paddingLeft = '5px';
            controlText.style.paddingRight = '5px';
            controlText.innerHTML = 'Check Score';
            controlUI.appendChild(controlText);
            var counter = 2;
            // Setup the click event listeners: .
            controlUI.addEventListener('click', function() {


                swal({
                    title: `Your score is: ${counter}`,
                    buttons: true,
                })
            });

        }



        // Note: This example requires that you consent to location sharing when
        // prompted by your browser. If you see the error "The Geolocation service
        // failed.", it means you probably did not give permission for the browser to
        // locate you.

        function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
                center: universum,
                zoom: 17,
                styles: [{
                        "featureType": "all",
                        "elementType": "all",
                        "stylers": [{
                                "saturation": "32"
                            },
                            {
                                "lightness": "-3"
                            },
                            {
                                "visibility": "on"
                            },
                            {
                                "weight": "1.18"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "landscape",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "landscape.man_made",
                        "elementType": "all",
                        "stylers": [{
                                "saturation": "-70"
                            },
                            {
                                "lightness": "14"
                            }
                        ]
                    },
                    {
                        "featureType": "poi",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "road",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "transit",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "water",
                        "elementType": "all",
                        "stylers": [{
                                "saturation": "100"
                            },
                            {
                                "lightness": "-14"
                            }
                        ]
                    },
                    {
                        "featureType": "water",
                        "elementType": "labels",
                        "stylers": [{
                                "visibility": "off"
                            },
                            {
                                "lightness": "12"
                            }
                        ]
                    }
                ]

            });


            var universumTest = new google.maps.LatLng(53, 8);
            var t = document.createTextNode("Hello World");

            var centerControlDiv = document.createElement('div');
            var centerControl = new CenterControl(centerControlDiv, map);

            centerControlDiv.index = 3;
            map.controls[google.maps.ControlPosition.TOP_CENTER].push(centerControlDiv);
            //kann an die Karte bewegen? Nein
            map.setOptions({
                draggable: false
            });






            //document.getElementById('hidemark').document.ready = hideMarkers;

            var infoWindow = new google.maps.InfoWindow({
                map: map
            });
            // MARITIM
            checked = true;

            function success(pos) {
                var crd = pos.coords;

                if (crd.latitude > 53.106300 && crd.latitude < 53.106777 && crd.longitude > 8.84300 && crd.longitude < 8.84600 && checked == true) {
                    checked = false;
                    universumMarker.setVisible(true)
                    circleUniversum.setVisible(true)

                    console.log("ich war in Universum")

                    counter++;


                    swal({

                            title: "CONGRATS!",
                            text: "You found the Universum!",
                            icon: "success",
                            buttons: true,
                        })
                        .then((willDelete) => {
                            if (willDelete) {


                                swal("The museum is designed like a whale. The windows should represent its teeths.", {
                                    icon: imageURL,
                                });
                            } else {
                                swal("We granted you 60 points! You found " + counter + " /3 spots in this area already");
                            }
                        });
                    navigator.geolocation.clearWatch(id);
                }
                if (crd.latitude > 53.106800 && crd.latitude < 53.106270 && crd.longitude > 8.841207 && crd.longitude < 8.841437 && checked == true) {
                    checked = false;
                    console.log("ich war in Haus")
                    swal({
                            title: "CONGRATS!",
                            text: "You found the Haus am Walde!",
                            icon: "success",
                            buttons: true,
                        })
                        .then((willDelete) => {
                            if (willDelete) {


                                swal("Norddeutsche und internationale Küche, Frühstück und selbstgebackener Kuchen im Backsteinhaus mit Biergarten.", {
                                    icon: haus,
                                });
                            } else {
                                swal("We granted you 40 points! You found " + counter + " /3 spots in this area already");
                            }
                        });
                    navigator.geolocation.clearWatch(id);
                }



                if (crd.latitude > 53.107600 && crd.latitude < 53.108120 && crd.longitude > 8.845700 && crd.longitude < 8.846000 && checked == true) {
                    checked = false;

                    counter++;
                    console.log("ich war in Leibniz")
                    /*universumMarker.setVisible(true);
                    universumMarker.setOptions({
                        'opacity': 0.5
                    })
                     */
                    //document.getElementById("map").setAttribute("style", "opacity:1; -moz-opacity:1; filter:alpha(opacity=100)");
                    swal({
                            title: "CONGRATS!",
                            text: "You found the Leibniz Centre for Marine Tropical Research!",
                            icon: "success",
                            buttons: true,
                        })
                        .then((willDelete) => {
                            if (willDelete) {


                                swal("The biggest german science center for ecology of tropic seas and coasts.", {
                                    icon: imageURLMaritim,
                                });
                            } else {
                                swal("We granted you 80 points! You found " + counter + " /3 spots in this area already");
                            }
                        });
                    navigator.geolocation.clearWatch(id);
                }


            }

            function error(err) {
                console.warn("error");
            }

            options = {
                enableHighAccuracy: false,
                timeout: 5000,
                maximumAge: 0
            };

            id = navigator.geolocation.watchPosition(success, error, options);


            var maritimMarker = new google.maps.Marker({
                position: maritim,

                map: map
            });
            var circleMaritim = new google.maps.Circle({
                map: map,
                radius: 100, // 10 miles in metres
                strokeColor: '#FF0000',
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: '#FF0000',
                fillOpacity: 0.35,
                map: map,
            });
            circleMaritim.bindTo('center', maritimMarker, 'position');

            // HAUS


            hausMarker = new google.maps.Marker({
                position: haus,

                map: map
            });
            circle = new google.maps.Circle({
                map: map,
                radius: 100, // 10 miles in metres
                fillColor: '#AA0000',
                strokeColor: '#FF0000',
                strokeOpacity: 0.001,
                strokeWeight: 2,
                fillColor: 'green',
                fillOpacity: 0.1,
            });
            circle.bindTo('center', hausMarker, 'position');
            // universum

            universumMarker = new google.maps.Marker({
                position: universum,
                map: map
            });
            universumMarker.setVisible(false)

            var circleUniversum = new google.maps.Circle({
                map: map,
                radius: 100, // 10 miles in metres
                fillColor: '#AA0000',
                strokeColor: '#FF0000',
                strokeOpacity: 0.001,
                strokeWeight: 2,
                fillColor: 'green',
                fillOpacity: 0.1,
            });

            circleUniversum.setVisible(false)

            circleUniversum.bindTo('center', universumMarker, 'position');
            navigator.geolocation.watchPosition(success, error);




            infoWindow.setPosition(pos);
            infoWindow.setContent('Thats you.');
            map.setCenter(universum);


        }

        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
            infoWindow.setPosition(pos);
            infoWindow.setContent(browserHasGeolocation ?
                'Error: The Geolocation service failed.' :
                'Error: Your browser doesn\'t support geolocation.');
        }

        function customAlert(msg) {
            var alertDiv = "<div style='position: fixed; top: 20px; left: 20px;'>" + "You found the universum" + "</div>";
            document.getElementsByTagName('body')[0].appendChild(alertDiv);
        }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB0P18EzZD--ertW6TztEi6cwlhfy_j6Ok&callback=initMap">
    </script>
    <script src="alertify.js"></script>



</body>

</html>