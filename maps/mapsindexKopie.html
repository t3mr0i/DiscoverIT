<!DOCTYPE html>
<html>

<head>

    <title>Geolocation</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <!-- include the core styles -->
    <link rel="stylesheet" href="style.css" />

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>


    <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map.(53.106733, 8.84503) */
        
        .swal-overlay {
            background-color: rgba(43, 165, 137, 0.45);
        }
        
        #map {
            height: 100%;
        }
        /* Optional: Makes the sample page fill the window. */
        
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

    </style>
</head>

<body>

    <div id="map"></div>
    <script>
        var overlay;
        var gooMarker = [];
        var counter = 0;
        var universumMarker;
        const imageURL = "universum.jpg";
        const imageURLMaritim = "reef.jpg";
        const imageURLHaus = "haus.jpg";

        var partnerMarkers = [{
                lat: 53.106572,
                lng: 8.841387,
                name: "UniversumTest",
                content: "Our home town and international hub."
            },
            {
                lat: 54,
                lng: 8,
                name: "Middle East",
                content: "Dubai desc"
            }
        ]


        var universum = {
            lat: 53.106733,
            lng: 8.84503
        };


        var maritim = {
            lat: 53.108020,
            lng: 8.845980
        };

        var haus = {
            //  lat: 53.106572,
            // lng: 
        };


        //universumMarker.setVisible(false);

        /*
         alertify.confirm("You found the universum!", function(e) {
                            if (e) {
                                alertify.success("You earned 60 Points.");
                                alertify.alert("The museum is designed like a whale. The windows should represent its teeths.");
                                // user clicked "ok"                                } else {
                                // user clicked "cancel"
        */
        //var lat = homeMarker.getPosition().ab;
        //var lng = homeMarker.getPosition().cb;

        function success(pos) {
            var crd = pos.coords;



            var checked = true;
            if (crd.latitude > 53.106300 && crd.latitude < 53.106777 && crd.longitude > 8.84300 && crd.longitude < 8.84600 && checked == true) {
                universumMarker.setVisible(true);
                checked = false;
                counter++;
                gooMarker[0].setVisible(true);
                showMarkers()
                /*universumMarker.setVisible(true);
                universumMarker.setOptions({
                    'opacity': 0.5
                })
                 */
                //document.getElementById("map").setAttribute("style", "opacity:1; -moz-opacity:1; filter:alpha(opacity=100)");
                swal({

                        title: "CONGRATS!",
                        text: "You found the Universum!",
                        icon: "success",
                        buttons: true,
                    })
                    .then((willDelete) => {
                        if (willDelete) {


                            swal("The museum is designed like a whale. The windows should represent its teeths.", {
                                icon: imageURL,
                            });
                        } else {
                            swal("We granted you 60 points! You found " + counter + " /3 spots in this area already");
                        }
                    });

            }
            if (crd.latitude > 53.106800 && crd.latitude < 53.106270 && crd.longitude > 8.841207 && crd.longitude < 8.841437 && checked == true) {
                checked = false;

                swal({
                        title: "CONGRATS!",
                        text: "You found the Haus am Walde!",
                        icon: "success",
                        buttons: true,
                    })
                    .then((willDelete) => {
                        if (willDelete) {


                            swal("Norddeutsche und internationale Küche, Frühstück und selbstgebackener Kuchen im Backsteinhaus mit Biergarten.", {
                                icon: imageURLHaus,
                            });
                        } else {
                            swal("We granted you 40 points! You found " + counter + " /3 spots in this area already");
                        }
                    });

            }



            if (crd.latitude > 53.107600 && crd.latitude < 53.108120 && crd.longitude > 8.845700 && crd.longitude < 8.846000 && checked == true) {
                checked = false;
                counter++;
                /*universumMarker.setVisible(true);
                universumMarker.setOptions({
                    'opacity': 0.5
                })
                 */
                //document.getElementById("map").setAttribute("style", "opacity:1; -moz-opacity:1; filter:alpha(opacity=100)");
                swal({
                        title: "CONGRATS!",
                        text: "You found the Leibniz Centre for Marine Tropical Research!",
                        icon: "success",
                        buttons: true,
                    })
                    .then((willDelete) => {
                        if (willDelete) {


                            swal("The biggest german science center for ecology of tropic seas and coasts.", {
                                icon: imageURLMaritim,
                            });
                        } else {
                            swal("We granted you 80 points! You found " + counter + " /3 spots in this area already");
                        }
                    });

            }
        }

        function error(err) {
            console.warn("error");
        }

        navigator.geolocation.watchPosition(success, error);


        // Note: This example requires that you consent to location sharing when
        // prompted by your browser. If you see the error "The Geolocation service
        // failed.", it means you probably did not give permission for the browser to
        // locate you.

        function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
                center: universum,
                zoom: 17,
                styles: [{
                        "featureType": "all",
                        "elementType": "all",
                        "stylers": [{
                                "saturation": "32"
                            },
                            {
                                "lightness": "-3"
                            },
                            {
                                "visibility": "on"
                            },
                            {
                                "weight": "1.18"
                            }
                        ]
                    },
                    {
                        "featureType": "administrative",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "landscape",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "landscape.man_made",
                        "elementType": "all",
                        "stylers": [{
                                "saturation": "-70"
                            },
                            {
                                "lightness": "14"
                            }
                        ]
                    },
                    {
                        "featureType": "poi",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "road",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "transit",
                        "elementType": "labels",
                        "stylers": [{
                            "visibility": "off"
                        }]
                    },
                    {
                        "featureType": "water",
                        "elementType": "all",
                        "stylers": [{
                                "saturation": "100"
                            },
                            {
                                "lightness": "-14"
                            }
                        ]
                    },
                    {
                        "featureType": "water",
                        "elementType": "labels",
                        "stylers": [{
                                "visibility": "off"
                            },
                            {
                                "lightness": "12"
                            }
                        ]
                    }
                ]

            });

            map.setOptions({
                draggable: false
            });

            hideMarkers()
            var universumTest = new google.maps.LatLng(53, 8);


            for (var i = 0; i < partnerMarkers.length; i++) {
                gooMarker.push(new google.maps.Marker({
                    position: new google.maps.LatLng(partnerMarkers[i].lat, partnerMarkers[i].lng),
                    map: map,
                    title: partnerMarkers[i].name
                }));
            }

            function hideMarkers() {
                for (var i = 0; i < gooMarker.length; i++) {
                    gooMarker[i].setVisible(false);
                }
            }

            function showMarkers() {
                for (var i = 0; i < gooMarker.length; i++) {
                    gooMarker[i].setVisible(true);
                }
            }

            //document.getElementById('hidemark').document.ready = hideMarkers;

            var infoWindow = new google.maps.InfoWindow({
                map: map
            });
            // MARITIM

            var maritimMarker = new google.maps.Marker({
                position: maritim,

                map: map
            });
            var circle = new google.maps.Circle({
                map: map,
                radius: 100, // 10 miles in metres
                strokeColor: '#FF0000',
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: '#FF0000',
                fillOpacity: 0.35,
                map: map,
            });
            circle.bindTo('center', maritimMarker, 'position');
            navigator.geolocation.watchPosition(success, error);

            // HAUS


            var hausMarker = new google.maps.Marker({
                position: haus,

                map: map
            });
            var circle = new google.maps.Circle({
                map: map,
                radius: 100, // 10 miles in metres
                fillColor: '#AA0000',
                strokeColor: '#FF0000',
                strokeOpacity: 0.001,
                strokeWeight: 2,
                fillColor: 'green',
                fillOpacity: 0.1,
            });
            circle.bindTo('center', hausMarker, 'position');
            navigator.geolocation.watchPosition(success, error);
            // universum
            var universumMarker = new google.maps.Marker({
                position: universum,






                map: map
            });

            var circle = new google.maps.Circle({
                map: map,
                radius: 100, // 10 miles in metres
                fillColor: '#AA0000',
                strokeColor: '#FF0000',
                strokeOpacity: 0.001,
                strokeWeight: 2,
                fillColor: 'green',
                fillOpacity: 0.1,
            });
            circle.bindTo('center', universumMarker, 'position');
            navigator.geolocation.watchPosition(success, error);

            // Try HTML5 geolocation.
            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(function(position) {

                        var pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude


                        };


                        infoWindow.setPosition(pos);
                        infoWindow.setContent('Location found.');
                        //map.setCenter(pos);



                    },
                    function() {
                        handleLocationError(true, infoWindow, map.getCenter());
                    });
            } else {
                // Browser doesn't support Geolocation
                handleLocationError(false, infoWindow, map.getCenter());
            }
        }

        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
            infoWindow.setPosition(pos);
            infoWindow.setContent(browserHasGeolocation ?
                'Error: The Geolocation service failed.' :
                'Error: Your browser doesn\'t support geolocation.');
        }

        function customAlert(msg) {
            var alertDiv = "<div style='position: fixed; top: 20px; left: 20px;'>" + "You found the universum" + "</div>";
            document.getElementsByTagName('body')[0].appendChild(alertDiv);
        }

    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB0P18EzZD--ertW6TztEi6cwlhfy_j6Ok&callback=initMap">


    </script>
    <script src="alertify.js"></script>

    <!-- Add an input button to initiate the toggle method on the overlay. -->
    <div id="floating-panel">
        <input type="button" value="Bremen Overview" onclick="overlay.toggle();"></input>
        <input type="button" value="Check score" onclick="overlay.toggleDOM();"></input>
    </div>

</body>

</html>
